using CoopSpectator.Infrastructure; // Підключаємо інфраструктурні утиліти (логер)
using CoopSpectator.Network; // Підключаємо мережевий менеджер моду

namespace CoopSpectator // Використовуємо кореневий namespace моду
{ // Починаємо блок простору імен
    /// <summary> // Документуємо клас
    /// Глобальний runtime-контекст моду (синглтони та стан). // Пояснюємо призначення
    /// </summary> // Завершуємо XML-коментар
    public static class CoopRuntime // Оголошуємо статичний клас, бо стан має бути доступний з будь-якого місця коду
    { // Починаємо блок класу
        public static NetworkManager Network { get; private set; } // Зберігаємо єдиний інстанс NetworkManager для всього моду

        public static void Initialize() // Оголошуємо ініціалізацію runtime (викликається з SubModule.OnSubModuleLoad)
        { // Починаємо блок методу
            if (Network != null) // Перевіряємо чи ми вже ініціалізовані, щоб не створювати дублікати
            { // Починаємо блок if
                return; // Виходимо, бо все вже створено
            } // Завершуємо блок if

            Network = new NetworkManager(); // Створюємо мережевий менеджер (поки без активного підключення)
            ModLogger.Info("CoopRuntime ініціалізовано."); // Логуємо факт ініціалізації для дебагу
        } // Завершуємо блок методу

        public static void Shutdown() // Оголошуємо коректне завершення runtime (викликається з SubModule.OnSubModuleUnloaded)
        { // Починаємо блок методу
            if (Network != null) // Перевіряємо чи NetworkManager створений, щоб не викликати методи на null
            { // Починаємо блок if
                Network.Shutdown(); // Коректно зупиняємо мережеві потоки та сокети
                Network = null; // Обнуляємо посилання, щоб GC міг прибрати об'єкти і щоб не було повторних викликів
            } // Завершуємо блок if

            ModLogger.Info("CoopRuntime завершено."); // Логуємо факт завершення для дебагу
        } // Завершуємо блок методу
    } // Завершуємо блок класу
} // Завершуємо блок простору імен

